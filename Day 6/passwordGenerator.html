<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Password Generator & Strength Checker</title>
    <style>
        :root {
            --bg: #0b1220;
            --panel: #101826;
            --muted: #94a3b8;
            --text: #e2e8f0;
            --brand: #7c3aed;
            --brand-2: #22d3ee;
            --ok: #10b981;
            --warn: #f59e0b;
            --bad: #ef4444;
            --ring: #334155;
            --card-radius: 18px;
            --shadow: 0 10px 24px rgba(0, 0, 0, .35);
        }

        * {
            box-sizing: border-box
        }

        html,
        body {
            height: 100%
        }

        body {
            margin: 0;
            background: radial-gradient(1200px 900px at 20% -10%, #1e293b44, transparent),
                radial-gradient(1200px 900px at 120% 20%, #0ea5e944, transparent), var(--bg);
            color: var(--text);
            font: 16px/1.45 Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial;
        }

        .wrap {
            max-width: 1100px;
            margin: 32px auto;
            padding: 0 16px
        }

        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 22px
        }

        .brand {
            font-weight: 800;
            letter-spacing: .2px;
            font-size: clamp(20px, 2vw, 28px)
        }

        .brand .grad {
            background: linear-gradient(135deg, var(--brand), var(--brand-2));
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent
        }

        header .note {
            color: var(--muted);
            font-size: .95rem
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 18px
        }

        @media (max-width: 980px) {
            .grid {
                grid-template-columns: 1fr
            }
        }

        .card {
            background: linear-gradient(180deg, #0f172aEE, #0b1220F2);
            border: 1px solid var(--ring);
            border-radius: var(--card-radius);
            padding: 18px;
            box-shadow: var(--shadow)
        }

        .card h2 {
            margin: 0 0 12px;
            font-size: 1.15rem
        }

        .row {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap
        }

        input[type="text"],
        input[type="password"],
        input[type="number"],
        select {
            width: 100%;
            padding: 12px 12px;
            border-radius: 12px;
            border: 1px solid var(--ring);
            background: #0b1220;
            color: var(--text)
        }

        input[type="range"] {
            width: 100%
        }

        .btn {
            background: #0b1220;
            border: 1px solid var(--ring);
            color: var(--text);
            padding: 10px 14px;
            border-radius: 12px;
            cursor: pointer
        }

        .btn.primary {
            background: linear-gradient(135deg, var(--brand), var(--brand-2));
            border: none;
            color: #0b1220;
            font-weight: 700
        }

        .btn.ghost {
            background: transparent;
            border: 1px dashed var(--ring)
        }

        .btn:disabled {
            opacity: .5;
            cursor: not-allowed
        }

        .kbd {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: .9rem;
            background: #0b1220;
            border: 1px solid var(--ring);
            border-radius: 10px;
            padding: 10px 12px;
            width: 100%
        }

        .muted {
            color: var(--muted)
        }

        .hint {
            font-size: .9rem;
            color: var(--muted);
            margin-top: 6px
        }

        .meter {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 6px;
            margin-top: 10px
        }

        .seg {
            height: 10px;
            background: #0f172a;
            border-radius: 999px;
            border: 1px solid #1f2937
        }

        .seg.fill.bad {
            background: linear-gradient(135deg, #7f1d1d, var(--bad));
        }

        .seg.fill.warn {
            background: linear-gradient(135deg, #7c2d12, var(--warn));
        }

        .seg.fill.ok {
            background: linear-gradient(135deg, #064e3b, var(--ok));
        }

        .pill {
            display: inline-block;
            border: 1px solid var(--ring);
            border-radius: 999px;
            padding: 4px 10px;
            font-size: .85rem;
            margin: 6px 6px 0 0;
            background: #0b1220
        }

        .section {
            margin-top: 14px;
            padding-top: 12px;
            border-top: 1px dashed var(--ring)
        }

        .flex {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap
        }

        .grow {
            flex: 1 1 auto
        }

        .badge {
            padding: 4px 8px;
            border-radius: 999px;
            border: 1px solid var(--ring);
            font-size: .8rem;
        }

        .badge.bad {
            border-color: var(--bad);
            color: var(--bad)
        }

        .badge.warn {
            border-color: var(--warn);
            color: var(--warn)
        }

        .badge.ok {
            border-color: var(--ok);
            color: var(--ok)
        }

        .sr {
            position: absolute;
            left: -9999px;
            top: auto;
            width: 1px;
            height: 1px;
            overflow: hidden
        }

        .small {
            font-size: .9rem
        }

        .footer {
            color: var(--muted);
            margin-top: 18px;
            font-size: .9rem
        }

        .copy-toast {
            position: fixed;
            bottom: 18px;
            right: 18px;
            background: #0b1220;
            border: 1px solid var(--ring);
            padding: 10px 12px;
            border-radius: 12px;
            box-shadow: var(--shadow);
            display: none
        }
    </style>
</head>

<body>
    <div class="wrap">
        <header>
            <div class="brand">üîê <span class="grad">Password Studio</span></div>
            <div class="note">All checks and generation run <strong>locally</strong>. Nothing leaves your browser.</div>
        </header>

        <div class="grid">
            <!-- Strength Checker -->
            <section class="card" aria-labelledby="checker_title">
                <h2 id="checker_title">Password Strength Checker</h2>
                <label class="small" for="pw">Enter password</label>
                <div class="row">
                    <input id="pw" type="password" class="kbd" placeholder="Type or paste a password‚Ä¶"
                        autocomplete="off" />
                    <button class="btn" id="togglePw" aria-pressed="false" title="Show/Hide">Show</button>
                    <button class="btn ghost" id="clearPw" title="Clear input">Clear</button>
                </div>

                <div class="section" aria-live="polite" id="live">
                    <div class="flex">
                        <div class="grow">
                            <div class="small muted">Strength</div>
                            <div id="strengthLabel" style="font-weight:700; font-size:1.05rem">‚Äî</div>
                        </div>
                        <div>
                            <span id="entropyBadge" class="badge">Entropy: ‚Äî</span>
                        </div>
                    </div>
                    <div class="meter" aria-hidden="true">
                        <div class="seg" data-i="0"></div>
                        <div class="seg" data-i="1"></div>
                        <div class="seg" data-i="2"></div>
                        <div class="seg" data-i="3"></div>
                        <div class="seg" data-i="4"></div>
                    </div>
                    <div class="hint" id="est">Estimated crack time: ‚Äî</div>

                    <div class="section">
                        <div class="small muted" style="margin-bottom:6px">Issues & Suggestions</div>
                        <div id="advice"></div>
                    </div>

                    <div class="section small">
                        <span class="muted">Character set detected:</span>
                        <span id="charsetPills"></span>
                    </div>
                </div>
            </section>

            <!-- Generator -->
            <section class="card" aria-labelledby="gen_title">
                <h2 id="gen_title">Password Generator</h2>

                <div class="row">
                    <div class="grow">
                        <label class="small" for="length">Length: <span id="lenVal">16</span></label>
                        <input id="length" type="range" min="8" max="64" step="1" value="16" />
                    </div>
                    <button class="btn" id="regen">Generate</button>
                    <button class="btn primary" id="copyGen">Copy</button>
                </div>

                <div class="row" style="margin-top:8px">
                    <input id="out" type="text" class="kbd" placeholder="Generated password shows here"
                        aria-label="Generated password" readonly>
                </div>

                <div class="section">
                    <div class="row">
                        <label class="small"><input type="checkbox" id="gLower" checked> a‚Äìz</label>
                        <label class="small"><input type="checkbox" id="gUpper" checked> A‚ÄìZ</label>
                        <label class="small"><input type="checkbox" id="gDigits" checked> 0‚Äì9</label>
                        <label class="small"><input type="checkbox" id="gSymbols" checked> Symbols</label>
                        <label class="small"><input type="checkbox" id="gNoAmbig"> Avoid ambiguous (0/O, 1/l/I,
                            etc.)</label>
                    </div>
                    <div class="hint">At least one character from each selected set is guaranteed.</div>
                </div>

                <div class="section">
                    <details>
                        <summary class="small">Passphrase mode (optional)</summary>
                        <div class="row" style="margin-top:8px">
                            <label class="small" for="words">Words: <span id="wordsVal">4</span></label>
                            <input id="words" type="range" min="3" max="8" value="4" />
                            <label class="small" for="sep">Separator</label>
                            <select id="sep">
                                <option>-</option>
                                <option>_</option>
                                <option>‚Ä¢</option>
                                <option> </option>
                            </select>
                            <label class="small"><input id="capitalize" type="checkbox"> Capitalize words</label>
                            <label class="small"><input id="wordDigits" type="checkbox"> Append 2 digits</label>
                            <label class="small"><input id="wordSymbol" type="checkbox"> Append a symbol</label>
                            <button class="btn" id="genPhrase">Generate passphrase</button>
                        </div>
                        <div class="hint">Passphrases are easier to remember. Use 4‚Äì6 words for stronger security.</div>
                    </details>
                </div>
            </section>
        </div>

        <div class="footer">
            Tip: For critical accounts, aim for <strong>‚â• 14 chars</strong> with a mix of upper/lower/digits/symbols, or
            a <strong>5‚Äì6 word</strong> passphrase. Use a password manager.
        </div>
    </div>

    <div id="toast" class="copy-toast" role="status" aria-live="polite">Copied!</div>

    <script>
        'use strict';

        // ---------- Utilities ----------
        const $ = (sel) => document.querySelector(sel);
        const $$ = (sel) => [...document.querySelectorAll(sel)];
        const clamp = (n, a, b) => Math.max(a, Math.min(b, n));
        const hasLower = (s) => /[a-z]/.test(s);
        const hasUpper = (s) => /[A-Z]/.test(s);
        const hasDigit = (s) => /\d/.test(s);
        const hasSymbol = (s) => /[^\da-zA-Z]/.test(s);

        const AMBIG = new Set(['0', 'O', 'o', '1', 'l', 'I', '|', '5', 'S', '2', 'Z', '8', 'B']);

        // small list of very common passwords and words to flag
        const COMMON = new Set([
            'password', '123456', '12345678', '123456789', 'qwerty', 'abc123', '111111', 'letmein', 'admin', 'welcome', 'monkey', 'dragon', 'iloveyou', 'baseball', 'football', 'princess', 'sunshine', 'login', 'passw0rd', 'qwertyuiop'
        ]);

        function humanTime(seconds) {
            if (!isFinite(seconds) || seconds <= 0) return 'instantly';
            const units = [['year', 31557600], ['day', 86400], ['hour', 3600], ['min', 60], ['sec', 1]];
            let s = seconds, out = [];
            for (const [n, v] of units) {
                const q = Math.floor(s / v); if (q) { out.push(q + " " + n + (q > 1 ? 's' : '')); s -= q * v; }
                if (out.length >= 2) break;
            }
            return out.length ? out.join(' ') : 'seconds';
        }

        function bitsToTime(bits, rate = 1e9) { // guesses/sec default 1e9
            const guesses = Math.pow(2, bits);
            return humanTime(guesses / rate);
        }

        function estimateEntropy(pw) {
            if (!pw) return 0;
            let pool = 0;
            if (hasLower(pw)) pool += 26;
            if (hasUpper(pw)) pool += 26;
            if (hasDigit(pw)) pool += 10;
            if (hasSymbol(pw)) pool += 33; // rough typical symbol set size
            if (!pool) return 0;
            // base estimate
            let bits = pw.length * Math.log2(pool);
            // penalties for obvious weaknesses
            if (/([a-zA-Z0-9])\1{2,}/.test(pw)) bits -= 8; // repeats like aaa, 111
            if (/(0123|1234|2345|abcd|qwerty|password)/i.test(pw)) bits -= 12;
            if (COMMON.has(pw.toLowerCase())) bits -= 20;
            return Math.max(0, bits);
        }

        function scoreStrength(bits) {
            // map entropy to 0..5 segments and label
            if (bits < 28) return { seg: 1, label: 'Very weak', tone: 'bad' };
            if (bits < 36) return { seg: 2, label: 'Weak', tone: 'bad' };
            if (bits < 60) return { seg: 3, label: 'Fair', tone: 'warn' };
            if (bits < 80) return { seg: 4, label: 'Strong', tone: 'ok' };
            return { seg: 5, label: 'Excellent', tone: 'ok' };
        }

        function analyze(pw) {
            const adv = [];
            const classes = [
                hasLower(pw) && 'lowercase a‚Äìz',
                hasUpper(pw) && 'uppercase A‚ÄìZ',
                hasDigit(pw) && 'digits 0‚Äì9',
                hasSymbol(pw) && 'symbols'
            ].filter(Boolean);

            if (!pw) adv.push('Enter a password to see analysis.');
            if (pw.length < 12) adv.push('Use at least 12 characters; more is better.');
            if (classes.length < 3) adv.push('Mix character types (upper/lower/digits/symbols).');
            if (/([a-zA-Z0-9])\1{2,}/.test(pw)) adv.push('Avoid repeated characters like "aaa" or "111".');
            if (/(0123|1234|2345|abcd|qwerty)/i.test(pw)) adv.push('Avoid sequences like 1234, abcd, qwerty.');
            if (COMMON.has(pw.toLowerCase())) adv.push('This is a very common password; change it completely.');

            return { classes, adv };
        }

        function setMeter(n, tone) {
            const segs = $$('.meter .seg');
            segs.forEach((el, i) => {
                el.className = 'seg';
                if (i < n) el.className = `seg fill ${tone}`;
            });
        }

        function setCharsetPills(classes) {
            const cont = $('#charsetPills');
            cont.innerHTML = '';
            if (!classes.length) { cont.innerHTML = '<span class="pill">‚Äî</span>'; return; }
            classes.forEach(c => {
                const span = document.createElement('span');
                span.className = 'pill'; span.textContent = c; cont.appendChild(span);
            });
        }

        // ---------- Checker interactions ----------
        const pw = $('#pw');
        const togglePw = $('#togglePw');
        const clearPw = $('#clearPw');
        const strengthLabel = $('#strengthLabel');
        const entropyBadge = $('#entropyBadge');
        const est = $('#est');
        const advice = $('#advice');

        function update() {
            const val = pw.value;
            const bits = estimateEntropy(val);
            const { seg, label, tone } = scoreStrength(bits);
            setMeter(seg, tone);
            strengthLabel.textContent = label;
            entropyBadge.textContent = `Entropy: ${bits.toFixed(1)} bits`;
            est.textContent = 'Estimated crack time: ' + bitsToTime(bits);

            const { classes, adv } = analyze(val);
            setCharsetPills(classes);
            advice.innerHTML = adv.length ? adv.map(a => `<span class="badge ${a.includes('common') ? 'bad' : a.includes('Avoid') ? 'warn' : 'warn'}">${a}</span>`).join(' ') : '<span class="badge ok">Looks solid. Consider going even longer.</span>';
        }

        pw.addEventListener('input', update);
        togglePw.addEventListener('click', () => {
            const show = pw.type === 'password';
            pw.type = show ? 'text' : 'password';
            togglePw.textContent = show ? 'Hide' : 'Show';
            togglePw.setAttribute('aria-pressed', String(show));
        });
        clearPw.addEventListener('click', () => { pw.value = ''; update(); pw.focus(); });

        // ---------- Generator ----------
        const rng = (n) => new Uint32Array(n).map(() => 0);
        function cryptoRandomInt(max) {
            // uniform 0..max-1 using crypto.getRandomValues
            const arr = new Uint32Array(1);
            let x;
            do { crypto.getRandomValues(arr); x = arr[0] & 0xfffffff; } while (x >= Math.floor(0xfffffff / max) * max);
            return x % max;
        }

        function pick(set) { return set[cryptoRandomInt(set.length)]; }

        const lower = 'abcdefghijklmnopqrstuvwxyz'.split('');
        const upper = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('');
        const digits = '0123456789'.split('');
        const symbols = Array.from("!@#$%^&*()-_=+[]{};:'\",.<>/?`~|\\");

        function buildPool(opts) {
            let pool = [];
            if (opts.lower) pool = pool.concat(lower);
            if (opts.upper) pool = pool.concat(upper);
            if (opts.digits) pool = pool.concat(digits);
            if (opts.symbols) pool = pool.concat(symbols);
            if (opts.noAmbig) pool = pool.filter(ch => !AMBIG.has(ch));
            return pool;
        }

        function shuffle(arr) {
            // Fisher-Yates using crypto
            for (let i = arr.length - 1; i > 0; i--) {
                const j = cryptoRandomInt(i + 1);
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function generatePassword(len, opts) {
            const pool = buildPool(opts);
            if (pool.length === 0) throw new Error('Select at least one character set');
            const res = [];
            // Guarantee at least one from each selected set
            const must = [];
            if (opts.lower) must.push(pick(opts.noAmbig ? lower.filter(c => !AMBIG.has(c)) : lower));
            if (opts.upper) must.push(pick(opts.noAmbig ? upper.filter(c => !AMBIG.has(c)) : upper));
            if (opts.digits) must.push(pick(opts.noAmbig ? digits.filter(c => !AMBIG.has(c)) : digits));
            if (opts.symbols) must.push(pick(opts.noAmbig ? symbols.filter(c => !AMBIG.has(c)) : symbols));
            while (res.length < len) res.push(pick(pool));
            // place must-haves and shuffle
            for (let i = 0; i < must.length && i < res.length; i++) res[i] = must[i];
            return shuffle(res).slice(0, len).join('');
        }

        // Passphrase generator (tiny in-memory wordlist)
        const WORDS = [
            'orange', 'river', 'planet', 'wisdom', 'canvas', 'ember', 'lunar', 'cobalt', 'meadow', 'nebula', 'quartz', 'velvet', 'maple', 'signal', 'voyage', 'ember', 'harbor', 'sprout', 'galaxy', 'quiet', 'saffron', 'violet', 'cinder', 'puzzle', 'falcon', 'pepper', 'island', 'zenith', 'aurora', 'beacon', 'cipher', 'comet', 'crystal', 'dawn', 'echo', 'feather', 'glider', 'honey', 'ink', 'jungle', 'karma', 'lantern', 'mango', 'nectar', 'onyx', 'pebble', 'quill', 'rover', 'saber', 'thistle', 'ultra', 'valor', 'willow', 'xenon', 'yonder', 'zephyr', 'alpha', 'brisk', 'crown', 'delta', 'ember', 'fable', 'grove', 'haven', 'ion', 'jazz', 'knight', 'lilac', 'monsoon', 'nova', 'orbit', 'prairie', 'quasar', 'ripple', 'solace', 'tidal', 'umber', 'verge', 'whisper', 'xylem', 'yoga', 'zen', 'apex', 'blossom', 'canyon', 'drift', 'ember', 'frost', 'glow', 'harvest', 'ivory', 'jade', 'keystone', 'lagoon', 'mystic', 'nectar', 'opal', 'pioneer', 'quarry', 'ranger', 'sage', 'tundra', 'unity', 'verdant'
        ];

        function generatePassphrase(nWords, { sep = '-', caps = false, digits = false, symbol = false } = {}) {
            const chosen = [];
            for (let i = 0; i < nWords; i++) {
                let w = WORDS[cryptoRandomInt(WORDS.length)];
                if (caps) w = w.charAt(0).toUpperCase() + w.slice(1);
                chosen.push(w);
            }
            let out = chosen.join(sep);
            if (digits) out += String(cryptoRandomInt(90) + 10); // two digits 10..99
            if (symbol) out += pick("!@#$%^&*".split(''));
            return out;
        }

        // Wire up generator controls
        const lenRange = $('#length');
        const lenVal = $('#lenVal');
        const out = $('#out');
        const regen = $('#regen');
        const copyGen = $('#copyGen');
        const gLower = $('#gLower');
        const gUpper = $('#gUpper');
        const gDigits = $('#gDigits');
        const gSymbols = $('#gSymbols');
        const gNoAmbig = $('#gNoAmbig');

        const wordsRange = $('#words');
        const wordsVal = $('#wordsVal');
        const sep = $('#sep');
        const capitalize = $('#capitalize');
        const wordDigits = $('#wordDigits');
        const wordSymbol = $('#wordSymbol');
        const genPhrase = $('#genPhrase');

        lenRange.addEventListener('input', () => { lenVal.textContent = lenRange.value; });
        wordsRange.addEventListener('input', () => { wordsVal.textContent = wordsRange.value; });

        function doGenerate() {
            try {
                const opts = { lower: gLower.checked, upper: gUpper.checked, digits: gDigits.checked, symbols: gSymbols.checked, noAmbig: gNoAmbig.checked };
                out.value = generatePassword(parseInt(lenRange.value, 10), opts);
                pw.value = out.value; // reflect into checker for instant score
                update();
            } catch (e) { out.value = e.message; }
        }

        regen.addEventListener('click', doGenerate);
        [gLower, gUpper, gDigits, gSymbols, gNoAmbig].forEach(el => el.addEventListener('change', doGenerate));

        genPhrase.addEventListener('click', () => {
            const phrase = generatePassphrase(parseInt(wordsRange.value, 10), { sep: sep.value, caps: capitalize.checked, digits: wordDigits.checked, symbol: wordSymbol.checked });
            out.value = phrase; pw.value = phrase; update();
        });

        copyGen.addEventListener('click', async () => {
            try { await navigator.clipboard.writeText(out.value); toast('Copied!'); } catch { toast('Copy failed'); }
        });

        function toast(msg) { const t = $('#toast'); t.textContent = msg; t.style.display = 'block'; setTimeout(() => t.style.display = 'none', 1300); }

        // init
        doGenerate(); update();
    </script>
</body>

</html>